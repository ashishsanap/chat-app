{"version":3,"sources":["api/chat/chat.controller.js"],"names":["ref","DB","exports","getDatabyMsgSessionId","req","res","next","console","log","params","user_mobile","sender_mobile","Chat","find","MsgSessionId","$in","sort","msg_timestamp","select","exec","err","chat","status","json","success","message","create","body"],"mappings":"AAAA;;AAEA;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;AACA;;;;;;AAEA,MAAMA,MAAMC,mBAAGD,GAAH,CAAO,QAAP,CAAZ;;AAEA;;AAEAE,QAAQC,qBAAR,GAAgC,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACtDC,UAAQC,GAAR,CAAYJ,IAAIK,MAAJ,CAAWC,WAAX,GAAyB,GAAzB,GAA+BN,IAAIK,MAAJ,CAAWE,aAAtD;AACAJ,UAAQC,GAAR,CAAYJ,IAAIK,MAAJ,CAAWE,aAAX,GAA2B,GAA3B,GAAiCP,IAAIK,MAAJ,CAAWC,WAAxD;AACCE,iBAAKC,IAAL,CAAU,EAAEC,cAAc,EAAEC,KAAK,CAAEX,IAAIK,MAAJ,CAAWC,WAAX,GAAyB,GAAzB,GAA+BN,IAAIK,MAAJ,CAAWE,aAA5C,EAA2DP,IAAIK,MAAJ,CAAWE,aAAX,GAA2B,GAA3B,GAAiCP,IAAIK,MAAJ,CAAWC,WAAvG,CAAP,EAAhB,EAAV,EACCM,IADD,CACM,EAACC,eAAe,CAAhB,EADN,EAC0BC,MAD1B,CACiC,MADjC,EACyCC,IADzC,CAC8C,UAASC,GAAT,EAAaC,IAAb,EAAkB;AAC9D,QAAID,GAAJ,EAAQ,OAAOf,IAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACC,SAAS,KAAV,EAAiBC,SAAS,uBAA1B,EAArB,CAAP;AACR,QAAI,CAACJ,IAAL,EAAW,OAAOhB,IAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACC,SAAS,KAAV,EAAiBC,SAAS,YAA1B,EAArB,CAAP;AACX,WAAOpB,IAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACC,SAAS,IAAV,EAAgBH,IAAhB,EAArB,CAAP;AACH,GALC;AAMH,CATD;;AAYAnB,QAAQwB,MAAR,GAAiB,UAAStB,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEGM,iBAAKc,MAAL,CAAYtB,IAAIuB,IAAhB,EAAsB,UAASP,GAAT,EAAcC,IAAd,EAAoB;AACxC,QAAID,GAAJ,EAAS,OAAOf,IAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACC,SAAS,KAAV,EAAiBC,SAAS,uBAA1B,EAArB,CAAP;AACT,WAAOpB,IAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACC,SAAS,IAAV,EAAgBC,SAAS,4BAAzB,EAArB,CAAP;AACD,GAHD;AAIH,CAhBD","file":"chat.controller.js","sourcesContent":["'use strict';\n\n/* eslint-disable import/prefer-default-export,no-mixed-operators,no-unused-vars,max-len */\nimport crypto from 'crypto';\nimport axios from 'axios';\nimport jwt from 'jsonwebtoken';\n\nimport DB from '../../config/firebase';\n\nimport { set, add } from '../../config/redis/redisoperation';\nimport Chat from './chat.model';\n\nconst ref = DB.ref('server');\n\n/*--------------------------------- Creates a new PaymentDetail in the DB.---------------------------------*/\n\nexports.getDatabyMsgSessionId = function(req, res, next) {\n   console.log(req.params.user_mobile + '_' + req.params.sender_mobile)\n   console.log(req.params.sender_mobile + '_' + req.params.user_mobile)\n    Chat.find({ MsgSessionId: { $in: [ req.params.user_mobile + '_' + req.params.sender_mobile, req.params.sender_mobile + '_' + req.params.user_mobile] }})\n    .sort({msg_timestamp: 1}).select('-_id').exec(function(err,chat){\n      if (err)return res.status(201).json({success: false, message: 'Something went worng!'});\n      if (!chat) return res.status(201).json({success: false, message: 'Not Found!'});\n      return res.status(200).json({success: true, chat});\n  });\n};\n\n\nexports.create = function(req, res, next) {\n\t// const chatRef = ref.child('chat');\n\t// const chatData = {\n //        msg_session_id: req.body.msg_session_id,\n //        msg_text: req.body.msg_text,\n //        user_mobile: req.body.msg_text,\n //        sender_mobile: req.body.msg_text,\n //      };\n\n //      chatRef.child(chatData.msg_session_id)\n //        .set(chatData);\n\n    Chat.create(req.body, function(err, chat) {\n      if (err) return res.status(201).json({success: false, message: 'Something went worng!'});\n      return res.status(201).json({success: true, message: 'Chat successfully Created!'});\n    });\n};"]}